@model IEnumerable<Parcours_integration.Models.Missions>

<table class="table table-bordered table-hover table-responsive" style="border-color: #bdbdbd">
    <thead>
        <tr>
            <th class="text-center" style="background-color: #efefef">
                Mission
            </th>
            <th class="text-center" style="background-color: #efefef; width: 15%">
                Service
            </th>
            <th class="text-center" style="background-color: #efefef; width: 19%">
                Interlocuteur
            </th>
            <th class="text-center" style="background-color: #efefef; width: 7%">
                Finie?
            </th>
            <th class="text-center" style="background-color: #efefef; width: 13%">
                Date de passage
            </th>
            @if (ViewBag.EstRH)
            {
                <th class="text-center" style="background-color: #efefef; width: 13%">Actions</th>
            }
        </tr>
    </thead>
    <tbody>
        @foreach (var item in Model)
        {
            var Interv = "Intervenants du secteurs : \n \n";
            foreach (var Personne in ViewBag.Intervenants)
            {
                if (Personne.Service.Nom == item.Nom_Secteur)
                {
                    Interv = String.Concat(Interv + Personne.Utilisateurs.Nom + ", ");
                }
            }

            if (!item.Applicable)
            {
                <tr style="background-color:lightgrey" align="center">
                    <td>
                        @Html.DisplayFor(modelItem => item.Nom_Mission)
                    </td>
                    <td data-bs-toggle="tooltip" title="@Interv">
                        @Html.DisplayFor(modelItem => item.Nom_Secteur)
                    </td>
                    <td>
                        <span>NON APPLICABLE</span>
                    </td>
                    <td>
                        <a class="btn btn-secondary disabled" href="" role="button">N/A</a>
                    </td>
                    <td>
                        <span>NON APPLICABLE</span>
                    </td>

                    @if (ViewBag.EstRH)
                    {
                        <td>
                            <a class="btn btn-primary poof" href="@Url.Action("NonApplicable", "Missions", new { id = item.ID })" style="display:block" role="button">Applicable</a>
                        </td>
                    }
                </tr>
            }
            else
            {
                <tr align="center">
                    <td>
                        @Html.DisplayFor(modelItem => item.Nom_Mission)
                    </td>
                    <td data-bs-toggle="tooltip" title="@Interv">
                        @Html.DisplayFor(modelItem => item.Nom_Secteur)
                    </td>
                    <td>
                        @if (item.Utilisateurs == null)
                        {
                            <p>----------------</p>
                        }
                        else
                        {
                            @Html.DisplayFor(modelItem => item.Utilisateurs.Nom)
                        }
                    </td>
                    <td>
                        @if (ViewBag.EstRH)
                        {
                            if (item.Passage)
                            {
                                <a class="btn btn-success" href="@Url.Action("Compléter", "Missions", new { id = item.ID})" role="button">OUI</a>
                            }
                            else
                            {
                                <a class="btn btn-danger" href="@Url.Action("Compléter", "Missions", new { id = item.ID})" role="button">NON</a>
                            }
                        }
                        else
                        {
                            if (item.Passage)
                            {
                                <a class="btn btn-success disabled" href="@Url.Action("Compléter", "Missions", new { id = item.ID})" role="button">OUI</a>
                            }
                            else
                            {
                                <a class="btn btn-danger disabled" href="@Url.Action("Compléter", "Missions", new { id = item.ID})" role="button">NON</a>
                            }
                        }
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.Date_passage)
                    </td>

                    @if (ViewBag.EstRH)
                    {
                        <td>
                            <div class="btn-group" role="group">
                                <a class="btn btn-primary poof" href="@Url.Action("Edit", "Missions", new { id = item.ID })" role="button">Modifier</a>
                                <a class="btn btn-primary poof" href="@Url.Action("NonApplicable", "Missions", new { id = item.ID })" role="button">N/A</a>
                            </div>
                        </td>
                    }
                </tr>
            }
        }
    </tbody>
</table>

<style>
    .poof{
        opacity:0;
    }

    .poof:hover{
        opacity:1;
    }

    .disabled{
        opacity:1;
    }
</style>