@model Parcours_integration.Models.Parcours

@{
    ViewBag.Title = "Détails du parcours";
}

<div>
    <div>
        <table class="table" style="margin: 0 auto; border-color: #ffffff00">
            <tr>
                <td style="width:33%">
                    <h2 style="font-weight:normal"><span style="font-weight:bold">@Html.DisplayFor(model => model.Nom)</span> @Html.DisplayFor(model => model.Prénom)</h2>
                </td>
                <td class="text-center" style="width:33%">
                    <h2 style="font-weight:normal"><span>@Html.DisplayFor(model => model.Contrat.Nom) - @Html.DisplayFor(model => model.Equipe.Nom)</span></h2>
                </td>
                <td class="text-end" style="width:33%">
                    <h2 style="font-weight:normal"><span>@ViewBag.PosteOccupé</span></h2>
                </td>
            </tr>
        </table>

        <div class="row">
            <div class="col-md-5">
                <h3 style="font-weight:normal; padding-left:8px"><span>Entré(e) le : @Html.DisplayFor(model => model.Date_entrée)</span></h3>
            </div>
            <div class="col-md-6">
                <h3 style="font-weight:normal; padding-left:13px"><span>Responsable : @Html.DisplayFor(model => model.Utilisateurs.Nom)</span></h3>
            </div>
        </div>
    </div>
    <hr />

    <div class="row">
        <div class="col-md-2">
            <a href="@Url.Action("Index")" class="btn btn-mini btn-primary bigger-10" style="width:100px">Retour</a>
        </div>

        @if (ViewBag.EstAdmin)
        {
            <div class="col-md-8" style="height:38px; display:inline-flex">
                <div class="btn-group" style="margin-left: auto">
                    <a href="@Url.Action("Edit", new { id = Model.ID })" class="btn btn-mini btn-primary bigger-10" style="max-width:120px;">Modifier</a>
                    <a href="@Url.Action("AddFile", new { id = Model.ID })" class="btn btn-mini btn-outline-info bigger-10" style="max-width: 200px">Documents du parcours</a>
                </div>
                @using (Html.BeginForm("Export", "Parcours", FormMethod.Post, new { style = "width:200px;margin-right: auto;margin-left:5px" }))
                {
                    <input type="hidden" name="GridHtml" />
                    <input type="hidden" value="@Model.ID" name="ID" />
                    <input class="btn btn-mini btn-warning icon-edit bigger-10" type="submit" id="btnSubmit" value="Exporter le parcours" />
                }
            </div>
            <div class="col-md-2">
                <a href="@Url.Action("Create", "Missions", new { id = Model.ID })" class="btn btn-mini btn-primary icon-edit bigger-10 float-end">Nouvelle mission</a>
            </div>
            <br /><br />
        }
        else
        {
            <div class="col-md-8 btn-group" style="height:38px">
                <div class="btn-group" style="margin-left: auto">
                    <a href="@Url.Action("Edit", new { id = Model.ID })" class="btn btn-mini btn-primary bigger-10 disabled" style="max-width:120px;">Modifier</a>
                    <a href="@Url.Action("AddFile", new { id = Model.ID })" class="btn btn-mini btn-outline-info bigger-10 disabled" style="max-width: 200px">Documents du parcours</a>
                </div>
                @using (Html.BeginForm("Export", "Parcours", FormMethod.Post, new { style = "width:200px;margin-right: auto;margin-left:5px" }))
                {
                    <input type="hidden" name="GridHtml" />
                    <input type="hidden" value="@Model.ID" name="ID" />
                    <input class="btn btn-mini btn-warning icon-edit bigger-10" type="submit" id="btnSubmit" value="Exporter le parcours" />
                }
            </div>
            <div class="col-md-2">
                <a href="@Url.Action("Create", "Missions", new { id = Model.ID })" class="btn disabled btn-mini btn-primary icon-edit bigger-10 float-end">Nouvelle mission</a>
            </div>
            <br /><br />
        }

    </div>
    <br />
    <div class="row">
        <div class="col-md-12">
            @Html.Partial("_Missions", Model.Missions)
        </div>
    </div>

    <div id="Grid" style="display: block">
        @Html.Partial("_HiddenMissions", Model.Missions)
    </div>
    
    

    @if (Model.Complété)
    {
        <hr />
        <div class="h-100 bg-light border rounded-1" style="padding:12px">
            <span style="font-weight:bold">Commentaire</span>
            <hr style="margin-bottom:5px;margin-top:5px" />
            @Html.Partial("_CommentBox")
        </div>
    }
</div>

<script type="text/javascript">
        $(function () {
            $("#btnSubmit").click(function () {
                $("input[name='GridHtml']").val($("#Grid").html());
            });
        });
</script>

<style>
    .commentBox {
        padding: 10px;
        border-radius: 10px;
    }

    .starFade {
        background-image: url('../../Docs/Images/starFade.png');
        min-width: 30px;
        min-height: 30px;
        display: inline-block;
        cursor: pointer;
    }

    .starFadeN {
        background-image: url('../../Docs/Images/starFade.png');
        min-width: 30px;
        min-height: 30px;
        display: inline-block;
    }

    .starGlow {
        background-image: url('../../Docs/Images/starGlow.png');
        min-width: 30px;
        min-height: 30px;
        display: inline-block;
        cursor: pointer;
    }

    .starGlowN {
        background-image: url('../../Docs/Images/starGlow.png');
        min-width: 30px;
        min-height: 30px;
        display: inline-block;
    }
</style>