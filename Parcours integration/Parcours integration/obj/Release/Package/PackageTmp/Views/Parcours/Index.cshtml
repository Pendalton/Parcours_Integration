@model IPagedList<Parcours_integration.Models.Parcours>

@{
    ViewBag.Title = "Liste des parcours d'intégration";
}

<h2>Liste des parcours d'intégration</h2>
<hr />

@using PagedList;
@using PagedList.Mvc;
<link href="~/Content/PagedList.css" rel="stylesheet" />
@using (Html.BeginForm())
{
    <div class="h-100 p-4 bg-light border rounded-3" style="padding:12px">
        <div class="row">
            <div style="width:30%">
                <div class="input-group">
                    <input type="text" id="Search" placeholder="Recherche" class="form-control" style="width:240px" />
                </div>
            </div>

            <div style="width:49%; display:flex">
                <div style="line-height:35px; margin:auto">
                    <label>CDI : &nbsp;@Html.CheckBox("CDI", new { onChange = "Actualiser()", @class = "sizeup" }) &nbsp;&nbsp;</label>
                    <label>CDD : &nbsp;@Html.CheckBox("CDD", new { onChange = "Actualiser()", @class = "sizeup" }) &nbsp;&nbsp;</label>
                    <label>Stage : &nbsp;@Html.CheckBox("Stage", new { onChange = "Actualiser()", @class = "sizeup" }) &nbsp;&nbsp;</label>
                    <label>Mutation : &nbsp;@Html.CheckBox("Mutation", new { onChange = "Actualiser()", @class = "sizeup" })&nbsp;&nbsp;</label>
                    <label>Intérimaire : &nbsp;@Html.CheckBox("Intérim", new { onChange = "Actualiser()", @class = "sizeup" })&nbsp;&nbsp;</label>
                    <br />
                    Du : &nbsp;@Html.TextBox("Datepicker", Model, "{0:yyyy-MM-dd}", new { onchange="this.form.submit()" ,type = "date", style="line-height : 30px"})&nbsp;&nbsp;
                    au &nbsp;&nbsp;@Html.TextBox("Datepicker2", Model, "{0:yyyy-MM-dd}", new { onChange = "Actualiser()", type = "date", style = "line-height : 30px" })<br />
                    @Html.DropDownList("Rythme", null, "--- Rythme ---", htmlAttributes: new { @onchange = "Actualiser()", @class="form-control dropdwn", style = "width:250px;margin-top:5px; height:35px;margin-left:20%" })
                </div>
            </div>

            <div style="width:21%">
                <div class="gap-1 d-md-flex btn-group-vertical">
                    @if (!ViewBag.Term)
                    {
                        <a class="btn btn-outline-secondary" href="@Url.Action("Index", new {Terminé = !ViewBag.Term})">Afficher les parcours terminés</a>
                    }
                    else
                    {
                        <a class="btn btn-outline-secondary" href="@Url.Action("Index", new {Terminé = !ViewBag.Term})">Cacher les parcours terminés</a>
                    }
                    @if (ViewBag.EstRH)
                    {
                        <a class="btn btn-primary btn-mini" href="@Url.Action("Create")" role="button">Nouveau parcours</a>
                    }
                </div>
            </div>
        </div>
    </div>
}
<br />

<div id="PIField" class="container-fluid">
    @Html.Partial("TableParc")
</div>

<script src="~/Scripts/jquery-3.6.0.min.js"></script>
<script>
    $(document).ready(function () {
        function Contains(text_one, text_two) {
            if (text_one.indexOf(text_two) != -1)
                return true;
        };
        
        $("#Search").keyup(function () {
            var searchText = $("#Search").val().toLowerCase();
            $(".Search").each(function () {
                if (!Contains($(this).text().toLowerCase(), searchText)) {
                    $(this).parent().hide();
                }
                else {
                    $(this).parent().show();
                }
            });
        });
    });

    function Relance(ID) {
        $.ajax({
            type: "POST",
            url: "Parcours/SendMail",
            data: '{ ID: "' + ID + '"}',
            contentType: "application/json; charset=utf-8",
        })
    }

    function Actualiser() {
        $.ajax({
            type: "POST",
            url: "Parcours/IndexAjax",
            data: '{CDI: "' + CDI.checked + '", CDD: "' + CDD.checked + '", Stage: "' + Stage.checked + '", Mutation: "' + Mutation.checked + '", Intérim: "' + Int_rim.checked + '", Datepicker: "' + Datepicker.value + '", Datepicker2: "' + Datepicker2.value + '", Rythme: "' + Rythme.value + '"}',
            contentType: "application/json; charset=utf-8",
            success: function (data) {
                console.log(data)
                $("#PIField").html(data);
            },
            error: function (data) {
                console.log(data);
            }
        })
    }
</script>

<style>
    .sizeup {
        transform: scale(1.5);
    }

    input[name="Datepicker"],
    input[name="Datepicker2"] {
        width: 190px;
    }
</style>